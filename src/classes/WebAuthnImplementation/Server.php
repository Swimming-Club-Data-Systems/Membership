<?php

namespace WebAuthnImplementation;

use Webauthn\PublicKeyCredentialRpEntity;

class Server
{
  public static function get()
  {
    $tenant = app()->tenant;

    $rpEntity = new PublicKeyCredentialRpEntity(
      $tenant->getName() . ' WebAuthn Server',
      $tenant->getDomain(),
      'data:image/webp;base64,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'
    );

    $publicKeyCredentialSourceRepository = new PublicKeyCredentialSourceRepository();

    $server = new \Webauthn\Server(
      $rpEntity,
      $publicKeyCredentialSourceRepository
    );

    return $server;
  }
}
