"use strict";(self.webpackChunksrc=self.webpackChunksrc||[]).push([[968],{36286:function(e,t,a){a.d(t,{km:function(){return r},oY:function(){return i},zv:function(){return l},pB:function(){return s},Cq:function(){return c},Td:function(){return u}});var n=a(99677);function r(e){return n.Z.getState()["SKIPCLEAR/GlobalSettings"][e]}function i(){return o("name")}function l(){return o("id")}function s(){return o("uuid")}function c(){return o("swim_england_code")}function o(e){return n.Z.getState()["SKIPCLEAR/Tenant"][e]}function u(e){document.title=e+" - "+r("club_name")}},39380:function(e,t,a){var n=a(67294),r=a(96974),i=a(39711);t.Z=e=>{const t=e.crumbs;if(0===t.length)return;const a=t.map((e=>{let t=(0,r.WU)(e.to);return(0,r.bS)({path:t.pathname,end:!0})?n.createElement("li",{className:"breadcrumb-item active",key:e.to,title:e.title,"aria-current":"page"},e.name):n.createElement("li",{className:"breadcrumb-item",key:e.to},n.createElement(i.rU,{to:e.to,title:e.title,state:{global_questionable_link:!0}},e.name))}));return n.createElement("nav",{"aria-label":"breadcrumb"},n.createElement("ol",{className:"breadcrumb"},a))}},79236:function(e,t,a){var n=a(67294),r=a(62598),i=a(35005);const l=e=>{const{isSubmitting:t,dirty:a,isValid:l,errors:s,handleReset:c}=(0,r.u6)();return n.createElement(n.Fragment,null,!1,n.createElement("div",{className:"row"},n.createElement("div",{className:"col-auto ms-auto"},!e.hideClear&&n.createElement(n.Fragment,null,n.createElement(i.Z,{variant:"secondary",type:"button",onClick:()=>{e.onClear&&e.onClear(),c()},disabled:t||!a},e.clearTitle||"Clear")," "),n.createElement(i.Z,{variant:"primary",type:"submit",disabled:!a||!l||t},e.submitTitle||"Submit"))))};t.Z=e=>{const{initialValues:t,validationSchema:a,onSubmit:i,submitTitle:s,hideClear:c,clearTitle:o,onClear:u,hideButtons:m,...d}=e;return n.createElement(n.Fragment,null,n.createElement(r.J9,{initialValues:t,validationSchema:a,onSubmit:i},n.createElement(r.l0,d,e.children,!m&&n.createElement(l,{submitTitle:s,hideClear:c,clearTitle:o,onClear:u}))))}},70977:function(e,t,a){var n=a(67294),r=a(62598),i=a(3330);function l(){return l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},l.apply(this,arguments)}t.Z=e=>{let{label:t,helpText:a,mb:s,disabled:c,...o}=e;const[u,m]=(0,r.U$)(o),{isSubmitting:d}=(0,r.u6)(),p=s||"mb-3";return n.createElement(n.Fragment,null,n.createElement(i.Z.Group,{className:p,controlId:o.id||o.name},n.createElement(i.Z.Label,null,t),n.createElement(i.Z.Control,l({isValid:m.touched&&!m.error,isInvalid:m.touched&&m.error,disabled:d||c},u,o)),m.touched&&m.error?n.createElement(i.Z.Control.Feedback,{type:"invalid"},m.error):null,a&&n.createElement(i.Z.Text,{className:"text-muted"},a)))}},71968:function(e,t,a){a.r(t),a.d(t,{default:function(){return w}});var n=a(67294),r=a(36286),i=a(21407),l=a(39380),s=a(96518),c=a(35005),o=a(88375),u=a(86025),m=a(16714),d=a(9669),p=a.n(d);const b=(e,t,a)=>fetch(t,{method:"POST",credentials:"same-origin",redirect:"error",headers:{"Content-Type":"application/json",Accept:"application/json",...a},body:JSON.stringify(e)}),y=e=>{const t=(e=e.replace(/-/g,"+").replace(/_/g,"/")).length%4;if(t){if(1===t)throw new Error("InvalidLengthError: Input base64url string is the wrong length to determine padding");e+=new Array(5-t).join("=")}return window.atob(e)},h=e=>btoa(String.fromCharCode(...e));var E=a(79236),g=a(70977),f=a(77289),w=()=>{const[e,t]=(0,n.useState)(null),[a,d]=(0,n.useState)(null),[w,v]=(0,n.useState)([]);(0,n.useEffect)((()=>{r.Td("Web Authentication")}),[]);const C=async()=>{const{data:e}=await p().get("/api/my-account/webauthn/authenticators");v(e.authenticators),d(e.username)};(0,n.useEffect)((()=>{(async()=>{await C()})()}),[]);const Z=(({actionUrl:e="/register",actionHeader:t={},optionsUrl:a="/register/options"},n={})=>async r=>{const i=await b(r,a,n),l=(e=>(e.challenge=Uint8Array.from(y(e.challenge),(e=>e.charCodeAt(0))),void 0!==e.user&&(e.user={...e.user,id:Uint8Array.from(window.atob(e.user.id),(e=>e.charCodeAt(0)))}),void 0!==e.excludeCredentials&&(e.excludeCredentials=e.excludeCredentials.map((e=>({...e,id:Uint8Array.from(y(e.id),(e=>e.charCodeAt(0)))})))),void 0!==e.allowCredentials&&(e.allowCredentials=e.allowCredentials.map((e=>({...e,id:Uint8Array.from(y(e.id),(e=>e.charCodeAt(0)))})))),e))(await i.json()),s=(e=>{const t={id:e.id,type:e.type,rawId:h(new Uint8Array(e.rawId)),response:{clientDataJSON:h(new Uint8Array(e.response.clientDataJSON))}};return void 0!==e.response.attestationObject&&(t.response.attestationObject=h(new Uint8Array(e.response.attestationObject))),void 0!==e.response.authenticatorData&&(t.response.authenticatorData=h(new Uint8Array(e.response.authenticatorData))),void 0!==e.response.signature&&(t.response.signature=h(new Uint8Array(e.response.signature))),void 0!==e.response.userHandle&&(t.response.userHandle=h(new Uint8Array(e.response.userHandle))),t})(await navigator.credentials.create({publicKey:l})),c=await b(s,e,t);if(!c.ok)throw c;const o=await c.text();return""!==o?JSON.parse(o):o})({actionUrl:"/api/my-account/webauthn/register",optionsUrl:"/api/my-account/webauthn/challenge"}),k=w.map((e=>n.createElement(s.Z,{key:e.id},n.createElement("div",{className:"row align-items-center"},n.createElement("div",{className:"col"},n.createElement("p",{className:"mb-0 fw-bold"},e.name||"Unnamed"),n.createElement("p",{className:"mb-0"},"Created at ",e.created_at)),n.createElement("div",{className:"col-auto"},n.createElement(c.Z,{variant:"secondary",onClick:()=>(async e=>{const a=await p().post("/api/my-account/webauthn/delete",{id:e});a.data.success?C():t(a.data.message)})(e.id)},"Delete"))))));return n.createElement(n.Fragment,null,n.createElement(i.Z,{breadcrumbs:n.createElement(l.Z,{crumbs:[{to:"/my-account",title:"My Account",name:"My Account"},{to:"/my-account/passkeys",title:"Manage your passkeys",name:"Passkeys"}]}),title:"Manage passkeys",subtitle:"Passwordless login for your club account"}),n.createElement("div",{className:"container-xl"},n.createElement("div",{className:"row"},n.createElement("div",{className:"col-lg-8"},"undefined"==typeof PublicKeyCredential&&n.createElement(n.Fragment,null,n.createElement(o.Z,{variant:"warning"},"We're sorry. Your web browser does not support the Web Authentication standard required to use passkeys. You'll need to keep using password based authentication for now.")),"undefined"!=typeof PublicKeyCredential&&n.createElement(n.Fragment,null,e&&n.createElement(o.Z,{variant:"danger",className:"mb-3"},e),n.createElement(u.Z,{className:"mb-3"},n.createElement(u.Z.Header,null,"Add a new passkey"),n.createElement(u.Z.Body,null,n.createElement(E.Z,{initialValues:{name:""},validationSchema:f.Ry({name:f.Z_().required("Please name your passkey so that you can identify the device it is used with")}),onSubmit:async(e,n)=>{try{await Z({username:a,passkey_name:e.name}),n.resetForm(),t(null),await C()}catch(e){t(e.message)}},hideClear:!0,submitTitle:"Add passkey"},n.createElement(g.Z,{name:"name",label:"Passkey name"})))),w.length>0&&n.createElement(u.Z,{className:"mb-3"},n.createElement(u.Z.Header,null,"Current passkeys"),n.createElement(m.Z,{variant:"flush"},k)))))))}}}]);
//# sourceMappingURL=968.921fbbc1bab2721e6f9e.js.map